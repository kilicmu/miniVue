{"version":3,"file":"vue.js","sources":["../utils/next-tick.js","../src/shared/contants.js","../src/global-api/assets.js","../src/utils.js","../src/global-api/extend.js","../src/global-api/mixin.js","../src/global-api/index.js","../src/observer/array.js","../src/observer/dep.js","../src/observer/index.js","../src/observer/scheduler.js","../src/observer/watcher.js","../src/state.js","../src/compiler/parser-html.js","../src/compiler/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/init.js","../src/vdom/vnode.js","../src/vdom/create-component.js","../src/vdom/create-element.js","../src/render.js","../src/index.js"],"sourcesContent":["const callbacks = []\r\n\r\nlet pending = false;\r\nconst p = Promise.resolve();\r\n/**\r\n * 清空callbacks\r\n */\r\nfunction flushCallbacks () {\r\n  pending = false;\r\n  const copies = callbacks.slice(0);\r\n  callbacks.length = 0;\r\n  copies.forEach(copies => {\r\n    copies();\r\n  })\r\n}\r\n\r\nfunction timerFunc () {\r\n  p.then(flushCallbacks);\r\n}\r\n\r\nexport function nextTick (cb, ctx) {\r\n  let _resolve;\r\n  callbacks.push(() => {\r\n    if (cb) {\r\n      cb.call(ctx);\r\n    } else if (_resolve) {\r\n      _resolve(ctx);\r\n    }\r\n  })\r\n\r\n  if (!pending) {\r\n    pending = true;\r\n    timerFunc();\r\n  }\r\n\r\n  if (!cb && typeof Promise !== 'undefined') {\r\n    return new Promise(resolve => {\r\n      _resolve = resolve;\r\n    })\r\n  }\r\n\r\n}","export const LIFECYCLE_HOOKS = [\r\n  'beforeCreate',\r\n  'created',\r\n  'beforeMount',\r\n  'mounted',\r\n  'beforeUpdate',\r\n  'updated',\r\n  'beforeDestroy',\r\n  'destroyed',\r\n  'activated',\r\n  'deactivated',\r\n  'errorCaptured',\r\n  'serverPrefetch'\r\n]\r\n\r\n\r\nexport const ASSET_TYPES = [\r\n  'component',\r\n  'directive',\r\n  'filter'\r\n]","import { ASSET_TYPES } from \"../shared/contants\";\r\n\r\nexport function initAssetRegisters (Vue) {\r\n  ASSET_TYPES.forEach(type => {\r\n    Vue[ type ] = function (id, definition) {\r\n      if (type === 'component') {\r\n        definition = this.options._base.extend(definition);\r\n      } else if (type === 'filter') {\r\n\r\n      } else if (type === 'directive') {\r\n\r\n      }\r\n      this.options[ type + 's' ][ id ] = definition;\r\n    }\r\n  })\r\n}","import { LIFECYCLE_HOOKS } from \"./shared/contants\";\r\n\r\nexport function isObject (data) {\r\n  return typeof data === \"object\" && data !== null;\r\n}\r\n\r\nexport function proxy (vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get () {\r\n      return vm[ source ][ key ];\r\n    },\r\n    set (newValue) {\r\n      vm[ source ][ key ] = newValue;\r\n    }\r\n  })\r\n}\r\nconst strategy = {}\r\nLIFECYCLE_HOOKS.forEach(hook => {\r\n  strategy[ hook ] = mergeHook;\r\n})\r\nfunction mergeHook (parentVal, childVal) {\r\n  if (childVal) {\r\n    if (parentVal) {\r\n      return parentVal.concat(childVal);\r\n    } else {\r\n      return [ childVal ];\r\n    }\r\n  } else {\r\n    return parentVal;\r\n  }\r\n}\r\n\r\nstrategy[ 'components' ] = function (parentVal, childVal) {\r\n\r\n  const res = Object.create(parentVal);\r\n  if (childVal) {\r\n    for (let key in childVal) {\r\n      res[ key ] = childVal[ key ];\r\n    }\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function mergeOptions (parent, child) {\r\n  const options = {};\r\n  function mergeField (key) {\r\n    if (strategy[ key ]) {\r\n      // debugger\r\n      return options[ key ] = strategy[ key ](parent[ key ], child[ key ]);\r\n    }\r\n    if (typeof parent[ key ] === 'object' && typeof child[ key ] === 'object') {\r\n      options[ key ] = {\r\n        ...parent[ key ],\r\n        ...child[ key ]\r\n      }\r\n    } else if (child[ key ] == null) {\r\n      options[ key ] = parent[ key ];\r\n    } else {\r\n      options[ key ] = child[ key ];\r\n    }\r\n    return options\r\n  }\r\n  for (const key in parent) {\r\n    mergeField(key);\r\n  }\r\n\r\n  for (const key in child) {\r\n    if (!parent.hasOwnProperty(key)) {\r\n      mergeField(key);\r\n    }\r\n  }\r\n  return options\r\n}\r\n\r\n\r\nexport function isReservedTag (tag) {\r\n  const str = 'input,div,ul,li,span,p';\r\n  const obj = {}\r\n  str.split(',').forEach(key => {\r\n    obj[ key ] = true\r\n  })\r\n  return !!obj[ tag ];\r\n}\r\n\r\n","import { mergeOptions } from \"../utils\";\r\n\r\nexport function initExtend (Vue) {\r\n  Vue.extend = function (extendOptions) {\r\n    let cid = 0;\r\n    const Sub = function VueComponent (options) {\r\n      this._init(options);\r\n    }\r\n\r\n    Sub.prototype = Object.create(this.prototype);\r\n    Sub.prototype.constructor = Sub;\r\n    Sub.cid = ++cid;\r\n    Sub.options = mergeOptions(this.options, extendOptions);\r\n    return Sub;\r\n  }\r\n}","import { mergeOptions } from \"../utils\";\r\n\r\nexport function initMixin (Vue) {\r\n  Vue.options = {}\r\n  Vue.mixin = function (mixin) {\r\n    this.options = mergeOptions(this.options, mixin);\r\n    return this;\r\n  }\r\n}","import { nextTick } from \"../../utils/next-tick\";\r\nimport { ASSET_TYPES } from \"../shared/contants\";\r\nimport { initAssetRegisters } from \"./assets\";\r\nimport { initExtend } from \"./extend\";\r\nimport { initMixin } from \"./mixin\";\r\n\r\n\r\nexport function initGlobalAPI (Vue) {\r\n  Vue.options = {}\r\n  initMixin(Vue);\r\n  ASSET_TYPES.forEach(type => {\r\n    Vue.options[ type + 's' ] = {}\r\n  })\r\n  Vue.options._base = Vue;\r\n  initExtend(Vue);\r\n  initAssetRegisters(Vue);\r\n\r\n}","\r\n\r\nconst oldArrayMethods = Array.prototype;\r\n\r\nconst methods = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'sort',\r\n  'reverse',\r\n  'splice'\r\n]\r\n\r\nexport const arrayMethods = Object.create(oldArrayMethods);\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[ method ] = function (...args) {\r\n    const ret = oldArrayMethods[ method ].apply(this, args);\r\n    const ob = this.__ob__;\r\n    let inserted;\r\n\r\n    switch (method) {\r\n      case \"push\":\r\n      case \"unshift\":\r\n        inserted = args;\r\n        break;\r\n      case 'splice': // splice方法的第三个参数才是插入的值\r\n        inserted = args.slice(2);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    inserted && ob.observeArray(inserted);\r\n    return ret;\r\n  }\r\n})","let uid = 0\r\n\r\nexport default class Dep {\r\n  constructor () {\r\n    this.id = uid++\r\n    this.subs = [];\r\n  }\r\n\r\n  addSub (sub) {\r\n    this.subs.push(sub);\r\n  }\r\n\r\n  depend () {\r\n    if (Dep.target) {\r\n      Dep.target.addDep(this);\r\n    }\r\n  }\r\n\r\n  notify () {\r\n    const subs = this.subs.slice()\r\n    subs.forEach(watcher => {\r\n      watcher.update();\r\n    })\r\n  }\r\n}\r\n\r\n//这个target是为了获取依赖的Watcher\r\nDep.target = null;\r\nconst targetStack = []\r\nexport function pushTarget (watcher) {\r\n  Dep.target = watcher;\r\n  targetStack.push(watcher);\r\n}\r\n\r\nexport function popTarget () {\r\n  targetStack.pop();\r\n  Dep.target = targetStack[ targetStack.length - 1 ]\r\n}","import { isObject } from \"../utils\";\r\nimport { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\nclass Observer {\r\n  constructor (data) {\r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false,\r\n      configurable: false\r\n    })\r\n    // 不需要对数组索引进行拦截\r\n    if (Array.isArray(data)) {\r\n      data.__proto__ = arrayMethods;\r\n\r\n    } else {\r\n      this.walk(data); //对数据分步处理\r\n    }\r\n  }\r\n\r\n  walk (data) {\r\n    Object.keys(data).forEach(key => {\r\n      defineReactive(data, key, data[ key ]); // 定义响应式变化\r\n    })\r\n  }\r\n\r\n  observeArray (data) {\r\n    for (const i in data) {\r\n      observe(data[ i ]);   // 解决数组内对象的响应式\r\n    }\r\n  }\r\n}\r\n\r\nexport function defineReactive (data, key, value) {\r\n  const dep = new Dep();\r\n  observe(value);\r\n  // debugger\r\n  // if (data.__ob__ instanceof Observer) {\r\n  //   return;\r\n  // }\r\n  Object.defineProperty(data, key, {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get () {\r\n      if (Dep.target) {\r\n        dep.depend();\r\n      }\r\n      return value;\r\n    },\r\n    set (newValue) {\r\n      if (newValue === value) return;\r\n      observe(value)\r\n      value = newValue;\r\n      dep.notify();\r\n    }\r\n  })\r\n}\r\n\r\n\r\n\r\nexport function observe (data) {\r\n  // TODO对数据监控\r\n  if (!isObject(data)) {\r\n    return;\r\n  }\r\n  // 对data数据做definePropert\r\n  return new Observer(data);\r\n}","import { nextTick } from \"../../utils/next-tick\";\r\n\r\nlet has = {};\r\nlet flushing = false;\r\nlet queue = [];\r\n\r\nfunction flushSchedulerQueue () {\r\n  queue.forEach(watcher => {\r\n    watcher.run();\r\n\r\n  })\r\n  has = {};\r\n  queue = [];\r\n}\r\n\r\nexport function queueWatcher (watcher) {\r\n\r\n  const id = watcher.id;\r\n  if (has[ id ] == null) {\r\n    has[ id ] = true;\r\n    if (!flushing) {\r\n      queue.push(watcher)\r\n    }\r\n    nextTick(flushSchedulerQueue, this);\r\n  }\r\n}","import { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatcher } from \"./scheduler\";\r\nlet id = 0;\r\nexport class Watcher {\r\n  constructor(vm, exprOrFn, cb, options) {\r\n    this.id = id++;\r\n    this.vm = vm;\r\n    this.exprOrFn = exprOrFn;\r\n    this.cb = cb;\r\n    this.options = options;\r\n    this.user = options.user; // 判断是否是$watch创造的 watcher\r\n    this.value = null;\r\n    this.lazy = options.lazy;\r\n    this.dirty = this.lazy;\r\n\r\n    if (typeof exprOrFn === \"string\") {\r\n      this.getter = function () {\r\n        const path = exprOrFn.split(\".\");\r\n        let obj = vm;\r\n        for (let p of path) {\r\n          obj = obj[p];\r\n        }\r\n        return obj;\r\n      };\r\n    } else {\r\n      this.getter = exprOrFn;\r\n    }\r\n\r\n    this.value = this.lazy ? undefined : this.get();\r\n  }\r\n\r\n  get() {\r\n    const vm = this.vm;\r\n    let value = undefined;\r\n    pushTarget(this);\r\n    value = this.getter.call(vm);\r\n    popTarget();\r\n    return value;\r\n  }\r\n\r\n  evaluate() {\r\n    this.value = this.get();\r\n    this.dirty = false;\r\n  }\r\n\r\n  addDep(dep) {\r\n    const id = dep.id;\r\n    dep.addSub(this);\r\n  }\r\n\r\n  update() {\r\n    if (this.lazy) {\r\n      this.dirty = true;\r\n    } else {\r\n      queueWatcher(this);\r\n    }\r\n  }\r\n\r\n  run() {\r\n    const newVal = this.get();\r\n    const oldVal = this.value;\r\n    this.value = newVal;\r\n    console.log(this.user);\r\n    if (this.user) {\r\n      this.cb.call(this.vm, newVal, oldVal);\r\n    }\r\n  }\r\n}\r\n","import { observe, defineReactive } from \"./observer/index\";\r\nimport { Watcher } from \"./observer/watcher\";\r\nimport { isObject } from \"./utils\";\r\nimport { proxy } from \"./utils\";\r\nimport Dep from \"./observer/dep\";\r\n\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  console.log(opts);\r\n  if (opts.props) {\r\n    initProps(vm, opts.props);\r\n  }\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm, opts.methods);\r\n  }\r\n\r\n  // compouted\r\n  // watch\r\n  if (opts.watch) {\r\n    initWatch(vm, opts.watch);\r\n  }\r\n\r\n  if (opts.computed) {\r\n    initComputed(vm, opts.computed);\r\n  }\r\n}\r\n\r\nfunction initComputed(vm, computed) {\r\n  const watchers = (vm._computedWatchers = Object.create(null));\r\n  for (let key in computed) {\r\n    const userDef = computed[key];\r\n    const getter = typeof userDef === \"function\" ? userDef : userDef.get;\r\n    watchers[key] = new Watcher(vm, getter, () => {}, { lazy: true });\r\n    if (!(key in vm)) {\r\n      defineComputed(vm, key, userDef);\r\n    }\r\n  }\r\n}\r\n\r\nconst sharedPropertyDefinition = {\r\n  enumerable: true,\r\n  configurable: true,\r\n  get: () => {},\r\n  set: () => {},\r\n};\r\n\r\nfunction defineComputed(target, key, userDef) {\r\n  if (typeof userDef === \"function\") {\r\n    sharedPropertyDefinition.get = createComputedGetter(key);\r\n    sharedPropertyDefinition.set = () => {};\r\n  } else {\r\n    sharedPropertyDefinition.get = userDef.get\r\n      ? userDef.get\r\n      : createComputedGetter(key);\r\n    sharedPropertyDefinition.set = userDef.set ? userDef.set : () => {};\r\n  }\r\n  Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\r\n\r\nfunction createComputedGetter(key) {\r\n  return function computedGetter() {\r\n    const watcher = this._computedWatchers && this._computedWatchers[key];\r\n    if (watcher) {\r\n      if (watcher.dirty) {\r\n        watcher.evaluate();\r\n      }\r\n      // if (Dep.target) {\r\n      //   watcher.depend();\r\n      // }\r\n      return watcher.value;\r\n    }\r\n  };\r\n}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\r\n  // 对数据进行观测\r\n  for (const key in data) {\r\n    proxy(vm, \"_data\", key);\r\n  }\r\n  observe(data);\r\n}\r\n\r\nfunction initProps(vm, propsOptions) {\r\n  const propsData = vm.$options.propsData;\r\n  const props = (vm._props = {});\r\n  const keys = (vm.$props._propKeys = []);\r\n  for (const key in propsOptions) {\r\n    keys.push(key);\r\n    const value = props.value;\r\n    defineReactive(props, key, value);\r\n\r\n    if (!(key in vm)) {\r\n      proxy(vm, `_props`, key);\r\n    }\r\n  }\r\n}\r\n\r\nfunction initMethods(vm, methods) {\r\n  const porps = vm.$options.props;\r\n  for (const key in methods) {\r\n    vm[key] =\r\n      typeof methods[key] !== \"function\"\r\n        ? function () {}\r\n        : methods[key].bind(vm);\r\n  }\r\n}\r\n\r\nfunction initWatch(vm, watch) {\r\n  for (const key in watch) {\r\n    const handler = watch[key];\r\n    if (Array.isArray[handler]) {\r\n      for (let h of handler) {\r\n        createWatcher(vm, key, h);\r\n      }\r\n    } else {\r\n      createWatcher(vm, key, handler);\r\n    }\r\n  }\r\n}\r\n\r\nfunction createWatcher(vm, expOrFn, handler, options) {\r\n  if (typeof handler === \"object\") {\r\n    options = handler;\r\n    handler = options.handler;\r\n  }\r\n  if (typeof handler === \"string\") {\r\n    handler = vm[handler];\r\n  }\r\n\r\n  return vm.$watch(expOrFn, handler, options);\r\n}\r\n\r\nexport function stateMixin(Vue) {\r\n  const dataDef = {};\r\n  dataDef.get = function () {\r\n    return this._data;\r\n  };\r\n  const propsDef = {};\r\n  propsDef.get = function () {\r\n    return this._props;\r\n  };\r\n  Object.defineProperty(Vue.prototype, \"$data\", dataDef);\r\n  Object.defineProperty(Vue.prototype, \"$props\", propsDef);\r\n}\r\n","//\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //<a:a>\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配结尾的</div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n\r\n\r\n// ast语法树树根\r\nlet currentParent; // 标识当前父亲\r\nconst stack = [];\r\nconst ELEMENT_TYPE = 1;\r\nconst TEXT_TYPE = 3;\r\n\r\nfunction createASTElement (tagName, attrs) {\r\n  return {\r\n    tag: tagName,\r\n    type: ELEMENT_TYPE,\r\n    children: [],\r\n    attrs,\r\n    parent: null\r\n  }\r\n}\r\n// <div><p></p></div>\r\n\r\nexport function parseHTML (html) {\r\n  let root = null;\r\n  function start (tagName, attrs) {\r\n    let element = createASTElement(tagName, attrs);\r\n    if (!root) {\r\n      root = element;\r\n    }\r\n    currentParent = element; // 把当前元素标记为父AST\r\n    stack.push(element);\r\n  }\r\n\r\n  function end (tagName) {\r\n    let element = stack.pop();\r\n    currentParent = stack[ stack.length - 1 ];\r\n    if (currentParent) {\r\n      element.parent = currentParent;\r\n      currentParent.children.push(element);\r\n    }\r\n  }\r\n\r\n  function chars (text) {\r\n    text = text.replace(/\\s/g, '');\r\n    if (text) {\r\n      currentParent.children.push({\r\n        text,\r\n        type: TEXT_TYPE,\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  // 使用正则解析\r\n  // 不断截取html字符串，对截取内容解析\r\n  while (html) {\r\n    let textEnd = html.indexOf('<');\r\n    if (textEnd == 0) {\r\n      const startTagMatch = parseStartTag();\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs);\r\n      }\r\n      const endTagMatch = html.match(endTag);\r\n      if (endTagMatch) {\r\n        end(endTagMatch[ 1 ]);\r\n        advance(endTagMatch[ 0 ].length)\r\n      }\r\n\r\n    }\r\n\r\n    let text;\r\n    if (textEnd >= 0) {\r\n      text = html.substring(0, textEnd); // 文本内容截取\r\n    }\r\n    if (text) {\r\n      chars(text);\r\n      advance(text.length);\r\n    }\r\n    if (textEnd < 0) {\r\n      break;\r\n    }\r\n  }\r\n\r\n\r\n  function parseStartTag () {\r\n    const start = html.match(startTagOpen);\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[ 1 ],\r\n        attrs: []\r\n      }\r\n      advance(start[ 0 ].length);\r\n      let end, attr;\r\n\r\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n        match.attrs.push({ \"name\": attr[ 1 ], \"value\": attr[ 3 ] || attr[ 4 ] || attr[ 5 ] })\r\n        advance(attr[ 0 ].length);\r\n      }\r\n      if (end) {\r\n        advance(end[ 0 ].length)\r\n        return match;\r\n      }\r\n    }\r\n  }\r\n\r\n  function advance (n) {\r\n    html = html.substring(n);\r\n  }\r\n  return root;\r\n}","import { parseHTML } from \"./parser-html\";\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // 匹配动态变量的+？\r\nfunction genProps (attrs) {\r\n  let str = '';\r\n  for (let i = 0; i < attrs.length; i++) {\r\n    const attr = attrs[ i ];\r\n    if (attr.name === 'style') {\r\n      const obj = {};\r\n      attr.value.split(\";\").forEach(item => {\r\n        const [ key, value ] = item.split(\":\");\r\n        obj[ key ] = value;\r\n      })\r\n      attr.value = obj;\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n  }\r\n  return str;\r\n}\r\n\r\nfunction genChildren (el) {\r\n  let children = el;\r\n  if (children && children.length > 0) {\r\n    return `${children.map(c => gen(c)).join(',')}`\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction gen (node) {\r\n  if (node.type === 1) {\r\n    // 元素\r\n    return generate(node);\r\n  } else { // 文本\r\n    // 正则 lastIndex问题\r\n    let text = node.text;\r\n    let tokens = [];\r\n    let match, index;\r\n    let lastIndex = defaultTagRE.lastIndex = 0;\r\n    while (match = defaultTagRE.exec(text)) {\r\n      index = match.index;\r\n      if (index > lastIndex) {\r\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)));\r\n      }\r\n      tokens.push(`_s(${match[ 1 ].trim()})`);\r\n      lastIndex = index + match[ 0 ].length;\r\n    }\r\n    if (lastIndex < text.length) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex)));\r\n    }\r\n    return `_v(${tokens.join('+')})`;\r\n  }\r\n}\r\n\r\nfunction generate (el) {\r\n  const children = genChildren(el.children);// 子节点\r\n  let code = `_c(\"${el.tag}\",{${el.attrs.length ? genProps(el.attrs) : 'undefined'}}\r\n  ${children ? `,${children}` : ''})\r\n  `\r\n  return code\r\n}\r\n\r\nexport function compileToFunction (template) {\r\n  // 编译模板为render函数\r\n\r\n  // 1. 将代码-》ast语法树 paser解析\r\n  const root = parseHTML(template);\r\n  console.log(root);\r\n  // console.log(root);\r\n  // 将AST语法树生成Render函数\r\n  let code = generate(root);\r\n\r\n  code = `with(this){ return ${code}}`\r\n\r\n  let renderFn = new Function(code);\r\n  return renderFn;\r\n  // 2. 标记静态书 markup解析\r\n\r\n  // 3. 通过ast产生的语法树，生成render函数 render（codegen）\r\n}","function sameVnode (a, b) {\r\n  return (\r\n    a.key === b.key && (\r\n      a.tag === b.tag\r\n    )\r\n  )\r\n}\r\n\r\nfunction createKeyToOldIdx (children, beginIdx, endIdx) {\r\n  let i, key;\r\n  const map = {}\r\n  for (i = beginIdx; i <= endIdx; ++i) {\r\n    key = children[ i ].key\r\n\r\n    map[ key ] = i;\r\n  }\r\n  return map;\r\n}\r\n\r\nexport function patch (oldVnode, vnode) {\r\n  if (!oldVnode) {\r\n    return createElm(vnode);\r\n  } else {\r\n    const isRealElement = oldVnode.nodeType;\r\n    if (isRealElement) { // 若oldVnode是一个真实节点，首渲染\r\n      const oldElm = oldVnode;\r\n      const parentElm = oldElm.parentNode;\r\n      const el = createElm(vnode);\r\n      parentElm.insertBefore(el, oldElm);\r\n      parentElm.removeChild(oldElm);\r\n      return el;\r\n    } else {\r\n      if (oldVnode.tag !== vnode.tag) {\r\n        const el = oldVnode.el; // 获取真实节点\r\n        oldVnode.el = el.parentNode.replaceChild(createElm(vnode), el);\r\n      }\r\n\r\n      if (!oldVnode.tag) {\r\n        if (oldVnode.text !== vnode.text) {\r\n          oldVnode.el.textContent = vnode.text;\r\n        }\r\n      }\r\n\r\n      const el = vnode.el = oldVnode.el;\r\n      updatePrototies(vnode, oldVnode);\r\n\r\n      const oldChildren = oldVnode?.children ?? [];\r\n      const newChildren = vnode?.children ?? [];\r\n      if (oldChildren.length && newChildren.length) {\r\n        updateChildren(el, oldChildren, newChildren)\r\n      } else if (newChildren.length > 0) {\r\n        for (let child of newChildren) {\r\n          el.appendChild(createElm(child));\r\n        }\r\n      } else if (oldChildren.length > 0) {\r\n        el.innerHTML = ''\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateChildren (parentElm, oldChildren, newChildren) {\r\n  let oldKeyToIdx;\r\n\r\n  let oldStartIndex = 0,\r\n    oldStartVnode = oldChildren[ oldStartIndex ],\r\n    oldEndIndex = oldChildren.length - 1,\r\n    oldEndVnode = oldChildren[ oldEndIndex ];\r\n\r\n  let newStartIndex = 0,\r\n    newStartVnode = newChildren[ newStartIndex ],\r\n    newEndIndex = newChildren.length - 1,\r\n    newEndVnode = newChildren[ newEndIndex ];\r\n  // debugger\r\n  while (newStartIndex <= newEndIndex && oldStartIndex <= oldEndIndex) {\r\n    if (!oldStartVnode) {\r\n      oldStartVnode = oldChildren[ ++oldStartIndex ];\r\n    } else if (!oldEndVnode) {\r\n      oldEndVnode = oldChildren[ --oldEndIndex ];\r\n    }\r\n    if (sameVnode(oldStartVnode, newStartVnode)) {\r\n      console.log(oldStartVnode, newStartVnode)\r\n      patch(oldStartVnode, newStartVnode); // 复用\r\n      oldStartVnode = oldChildren[ ++oldStartIndex ];\r\n      newStartVnode = newChildren[ ++newStartIndex ];\r\n    } else if (sameVnode(oldEndVnode, newEndVnode)) {\r\n      patch(oldEndVnode, newEndVnode);\r\n      oldEndVnode = oldChildren[ --oldEndIndex ];\r\n      newEndVnode = newChildren[ --newEndIndex ];\r\n    } else if (sameVnode(oldStartVnode, newEndVnode)) {\r\n      patch(oldStartVnode, newEndVnode);\r\n      parentElm.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling);\r\n      oldStartVnode = oldChildren[ ++oldStartIndex ];\r\n      newEndVnode = newChildren[ --newEndIndex ];\r\n    } else if (sameVnode(oldEndVnode, newStartVnode)) {\r\n      // debugger\r\n      patch(oldEndVnode, newStartVnode);\r\n      parentElm.insertBefore(oldEndVnode.el, oldStartVnode.el);\r\n      oldEndVnode = oldChildren[ --oldEndIndex ];\r\n      newStartVnode = newChildren[ ++newStartIndex ];\r\n    } else { // 乱序\r\n      // 通过老key做映射表\r\n      // 在映射表如果有当前newVnode则将那个node移动到oldEndVnode前面\r\n      // 如果没有则新建一个newVnode的节点然后吧这个节点插入到startVnode前\r\n      if (!oldKeyToIdx) oldKeyToIdx = createKeyToOldIdx(oldChildren, oldStartIndex, oldEndIndex);\r\n      let idxInOld = oldKeyToIdx[ newStartVnode.key ]\r\n      if (!idxInOld) {\r\n\r\n        parentElm.insertBefore(createElm(newStartVnode), oldStartVnode.el);\r\n      } else {\r\n        const vnodeToMove = oldChildren[ idxInOld ];\r\n        oldChildren[ idxInOld ] = undefined;\r\n        console.log(\"-------\", oldStartVnode);\r\n        parentElm.insertBefore(vnodeToMove.el, oldStartVnode.el);\r\n        patch(vnodeToMove, newStartVnode);\r\n      }\r\n      newStartVnode = newChildren[ ++newStartIndex ];\r\n    }\r\n  }\r\n\r\n  if (newStartIndex <= newEndIndex) {\r\n    for (let i = newStartIndex; i <= newEndIndex; ++i) {\r\n      // parentElm.appendChild(createElm(newChildren[ i ]));\r\n      const el = newChildren[ newEndIndex + 1 ]?.el ?? null;\r\n      // console.log('----', el, newChildren[ i ]);\r\n      parentElm.insertBefore(createElm(newChildren[ i ]), el);\r\n    }\r\n  }\r\n\r\n  if (oldStartIndex <= oldEndIndex) {\r\n    for (let i = oldStartIndex; i <= oldEndIndex; ++i) {\r\n      const child = oldChildren[ i ];\r\n      if (child != undefined) {\r\n        parentElm.removeChild(child.el);\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport function createElm (vnode) {\r\n  const { tag, children, key, data, text } = vnode;\r\n  if (typeof tag === 'string') {\r\n    // TODO 组件判断\r\n    if (createComponent(vnode)) {\r\n      return vnode.el = vnode.componentInstance.$el;\r\n    }\r\n    vnode.el = document.createElement(tag);\r\n    updatePrototies(vnode);\r\n    children.forEach(child => {\r\n      return vnode.el.appendChild(createElm(child))\r\n    })\r\n  } else {\r\n    vnode.el = document.createTextNode(text);\r\n  }\r\n  return vnode.el;\r\n}\r\n\r\nfunction createComponent (vnode) {\r\n  let d = vnode.data;\r\n  d.hooks && d.hooks.init && d.hooks.init(vnode)\r\n  // if ((d = d.hooks) && (d = d.init)) {\r\n  //   d(vnode);\r\n  // }\r\n  if (vnode.componentInstance) {\r\n    return true;\r\n  }\r\n}\r\n\r\nfunction updatePrototies (vnode, oldVnode) {\r\n  const newProps = vnode.data || {};\r\n  const el = vnode.el;\r\n  if (oldVnode) {\r\n    const oldProps = oldVnode.data || {};\r\n    // 处理style\r\n    const oldStyle = oldProps.style ?? {};\r\n    const newStyle = newProps.style ?? {};\r\n\r\n    for (let key in oldStyle) {\r\n      if (!newStyle[ key ]) el.style[ key ] = ''\r\n    }\r\n\r\n    for (let key in oldProps) {\r\n      if (!newProps[ key ]) {\r\n        el.removeAttribute(key);\r\n      }\r\n    }\r\n  }\r\n\r\n  for (const key in newProps) {\r\n    if (key === 'style') {\r\n      for (const styleName in newProps.style) {\r\n        el.style[ styleName.trim() ] = newProps.style[ styleName ]\r\n      }\r\n    } else if (key === 'class') {\r\n      el.className = newProps.class;\r\n    } else if (key !== 'undefined') {\r\n      el.setAttribute(key, newProps[ key ]);\r\n    }\r\n  }\r\n}","import { Watcher } from \"./observer/watcher\";\r\nimport { patch } from \"./vdom/patch\";\r\nexport function mountComponent (vm, el) {\r\n  const opts = vm.$options;\r\n  vm.$el = el;\r\n  callHook(vm, 'beforeMount');\r\n  const updateComponent = function () {\r\n    callHook(vm, 'beforeUpdate');\r\n    // 1. 通过_render方法生成虚拟dom\r\n    // 2. _update方法通过vnode生成真实dom\r\n    vm._update(vm._render());\r\n    callHook(vm, 'updated');\r\n  }\r\n  // 通过生成Watcher达成首次渲染\r\n  new Watcher(vm, updateComponent, () => { }, true);\r\n  callHook(vm, 'mounted');\r\n}\r\n\r\nexport function lifecycleMixin (Vue) {\r\n  Vue.prototype._update = function (vnode) {\r\n    const vm = this;\r\n    // vm.$el = patch(vm.$el, vnode);\r\n    const prevVnode = vm._vnode;\r\n    vm._vnode = vnode;\r\n    if (!prevVnode) {\r\n      vm.$el = patch(vm.$el, vnode);\r\n    } else {\r\n      vm.$el = patch(prevVnode, vnode);\r\n    }\r\n  }\r\n}\r\n\r\nexport function callHook (vm, hook) {\r\n  const handlers = vm.$options[ hook ];\r\n  if (handlers) {\r\n    handlers.forEach(i => i.call(vm));\r\n  }\r\n}","import { initState } from \"./state\"\r\nimport { compileToFunction } from \"./compiler/index\";\r\nimport { callHook, mountComponent } from \"./lifecycle\"\r\nimport { initGlobalAPI } from \"./global-api/index\"\r\nimport { mergeOptions } from \"./utils\";\r\nimport { nextTick } from \"../utils/next-tick\";\r\nimport { Watcher } from \"./observer/watcher\";\r\n\r\n\r\nexport function initMixin (Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    //Vue的内部属性#options 用户传递所以参数\r\n    const vm = this;\r\n    // console.log(vm.constructor.options, options)\r\n    vm.$options = mergeOptions(vm.constructor.options, options);\r\n    // console.log('opt', vm.$options)\r\n    callHook(vm, 'beforeCreate');\r\n    initState(vm); // 初始化状态\r\n\r\n    callHook(vm, 'created');\r\n\r\n    // 通过模板渲染\r\n\r\n    if (vm.$options.el) { // 用户提供挂载节点\r\n      vm.$mount(vm.$options.el);\r\n    }\r\n  }\r\n\r\n  Vue.prototype.$mount = function (el) {\r\n    el = document.querySelector(el);\r\n    const vm = this;\r\n    // 同时存在template与render使用render，如果没有则使用id=“app”的模板\r\n    // 将template转换为render函数挂载到opts上\r\n    const opts = this.$options;\r\n\r\n    if (!opts.render) { // 如果没有render，则编译模板\r\n      let template = opts.template;\r\n      // console.log('opts---', opts);\r\n      if (!template && el) {\r\n        template = el.outerHTML;\r\n      }\r\n      // console.log(template)\r\n      const render = compileToFunction(template);\r\n      opts.render = render;\r\n    }\r\n    //  opts.render;\r\n    mountComponent(vm, el);\r\n  }\r\n\r\n  Vue.prototype.$nextTick = nextTick;\r\n  Vue.prototype.$watch = function (expOrFn, cb, options = {}) {\r\n    const vm = this;\r\n    options.immediate = options.immediate ? options.immediate : true;\r\n    options.user = true;\r\n    const watcher = new Watcher(vm, expOrFn, cb, options)\r\n    if (options.immediate) {\r\n      try {\r\n        cb.call(vm, watcher.value)\r\n      } catch (error) {\r\n        handleError(error, vm, `callback for immediate watcher \"${watcher.expression}\"`)\r\n      }\r\n    }\r\n  };\r\n}","export function vnode (tag, data, key, children, text, componentOptions) {\r\n  return {\r\n    tag,\r\n    data,\r\n    key,\r\n    children,\r\n    text,\r\n    componentOptions\r\n  }\r\n}","import { isObject } from \"../utils\";\r\nimport { vnode } from \"./vnode\";\r\n\r\nexport function createComponent (vm, tag, data, key, children, Ctor) {\r\n  if (isObject(Ctor)) {\r\n    Ctor = vm.$options._base.extend(Ctor);\r\n  }\r\n\r\n  data.hooks = {\r\n    init (vnode) {\r\n      const child = vnode.componentInstance = new Ctor({ _isComponent: true })\r\n      child.$mount();\r\n    },\r\n\r\n  }\r\n\r\n  return vnode(`vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, { Ctor, children });\r\n}","import { isReservedTag } from \"../utils\";\r\nimport { createComponent } from \"./create-component\";\r\nimport { vnode } from \"./vnode\";\r\n\r\nexport function createElement (vm, tag, data, ...children) {\r\n  let { key } = data;\r\n  if (key) {\r\n    delete data[ key ];\r\n  }\r\n\r\n  if (isReservedTag(tag)) {\r\n    return vnode(tag, data, key, children, undefined);\r\n  } else {\r\n    let Ctor = vm.$options.components[ tag ];\r\n    return createComponent(vm, tag, data, key, children, Ctor);\r\n  }\r\n\r\n}\r\n\r\nexport function createTextNode (vm, text) {\r\n\r\n  return vnode(undefined, undefined, undefined, undefined, text);\r\n}\r\n\r\n","import { createElement, createTextNode } from \"./vdom/create-element\";\r\nexport function renderMixin (Vue) {\r\n  // 获取VNode\r\n  // _c创建元素虚拟节点\r\n  Vue.prototype._c = function () {\r\n    return createElement(this, ...arguments);\r\n  }\r\n  // _a 创建文本虚拟节点\r\n  Vue.prototype._v = function (text) {\r\n    return createTextNode(this, text)\r\n  }\r\n  // _s JSOM.stringify();\r\n  Vue.prototype._s = function (val) {\r\n    return val == null ? '' : (typeof val === 'object' ? JSON.stringify(val) : val);\r\n  }\r\n  Vue.prototype._render = function () {\r\n    const vm = this;\r\n    const { render } = vm.$options\r\n    const vnode = render.call(vm);\r\n    return vnode;\r\n  }\r\n}","import { initGlobalAPI } from \"./global-api/index\";\r\nimport { initMixin } from \"./init\"\r\nimport { lifecycleMixin } from \"./lifecycle\"\r\nimport { renderMixin } from \"./render\";\r\nimport { stateMixin } from \"./state\";\r\n\r\nfunction Vue (options) {\r\n  // 初始化操作\r\n  this._init(options);\r\n}\r\n\r\ninitMixin(Vue);\r\nlifecycleMixin(Vue);\r\nrenderMixin(Vue);\r\ninitGlobalAPI(Vue);\r\nstateMixin(Vue);\r\n\r\n\r\n\r\nexport default Vue;"],"names":["callbacks","pending","p","Promise","resolve","flushCallbacks","copies","slice","length","forEach","timerFunc","then","nextTick","cb","ctx","_resolve","push","call","LIFECYCLE_HOOKS","ASSET_TYPES","initAssetRegisters","Vue","type","id","definition","options","_base","extend","isObject","data","proxy","vm","source","key","Object","defineProperty","get","set","newValue","strategy","hook","mergeHook","parentVal","childVal","concat","res","create","mergeOptions","parent","child","mergeField","hasOwnProperty","isReservedTag","tag","str","obj","split","initExtend","extendOptions","cid","Sub","VueComponent","_init","prototype","constructor","initMixin","mixin","initGlobalAPI","oldArrayMethods","Array","methods","arrayMethods","method","args","ret","apply","ob","__ob__","inserted","observeArray","uid","Dep","subs","sub","target","addDep","watcher","update","targetStack","pushTarget","popTarget","pop","Observer","value","enumerable","configurable","isArray","__proto__","walk","keys","defineReactive","i","observe","dep","depend","notify","has","queue","flushSchedulerQueue","run","queueWatcher","Watcher","exprOrFn","user","lazy","dirty","getter","path","undefined","addSub","newVal","oldVal","console","log","initState","opts","$options","props","initProps","initData","initMethods","watch","initWatch","computed","initComputed","watchers","_computedWatchers","userDef","defineComputed","sharedPropertyDefinition","createComputedGetter","computedGetter","evaluate","_data","propsOptions","propsData","_props","$props","_propKeys","porps","bind","handler","h","createWatcher","expOrFn","$watch","stateMixin","dataDef","propsDef","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","children","parseHTML","html","root","start","element","end","chars","text","replace","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","attr","n","defaultTagRE","genProps","name","item","JSON","stringify","genChildren","el","map","c","gen","join","node","generate","tokens","index","lastIndex","exec","trim","code","compileToFunction","template","renderFn","Function","sameVnode","a","b","createKeyToOldIdx","beginIdx","endIdx","patch","oldVnode","vnode","createElm","isRealElement","nodeType","oldElm","parentElm","parentNode","insertBefore","removeChild","replaceChild","textContent","updatePrototies","oldChildren","newChildren","updateChildren","appendChild","innerHTML","oldKeyToIdx","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","nextSibling","idxInOld","vnodeToMove","createComponent","componentInstance","$el","document","createElement","createTextNode","d","hooks","init","newProps","oldProps","oldStyle","style","newStyle","removeAttribute","styleName","className","setAttribute","mountComponent","callHook","updateComponent","_update","_render","lifecycleMixin","prevVnode","_vnode","handlers","$mount","querySelector","render","outerHTML","$nextTick","immediate","error","handleError","expression","componentOptions","Ctor","_isComponent","components","renderMixin","_c","arguments","_v","_s","val"],"mappings":"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"}